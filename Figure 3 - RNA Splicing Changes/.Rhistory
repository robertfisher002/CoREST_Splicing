library(enrichplot)
library(clusterProfiler)
library(ggrepel)
library("ggVennDiagram")
library(eulerr)
library(stringr)
library(egg)
library(enrichplot)
library(clusterProfiler)
library(ggrepel)
library("ggVennDiagram")
library(eulerr)
library(stringr)
library(ComplexUpset)
library(ComplexHeatmap)
library(viridis)
library(dplyr)
library(tidyverse)
library(ggplot2)
library(ggpubr)
library(matrixStats)
SE_1205Lu <- read.delim("/Users/rjfisher/Library/Mobile Documents/com~apple~CloudDocs/BUSM/Alani Lab/DATA/CoREST Splicing/rmats/raw_rmats/1205Lu/SE_1205.txt")
SE_1205Lu <- read.delim("/Users/rjfisher/Library/Mobile Documents/com~apple~CloudDocs/BUSM/Alani Lab/DATA/CoREST Splicing/rmats/raw_rmats/1205Lu/SE_1205.txt")
A3SS_1205Lu <- read.delim("/Users/rjfisher/Library/Mobile Documents/com~apple~CloudDocs/BUSM/Alani Lab/DATA/CoREST Splicing/rmats/raw_rmats/1205Lu/A3SS_1205.txt")
A5SS_1205Lu <- read.delim("/Users/rjfisher/Library/Mobile Documents/com~apple~CloudDocs/BUSM/Alani Lab/DATA/CoREST Splicing/rmats/raw_rmats/1205Lu/A5SS_1205.txt")
MXE_1205Lu <- read.delim("/Users/rjfisher/Library/Mobile Documents/com~apple~CloudDocs/BUSM/Alani Lab/DATA/CoREST Splicing/rmats/raw_rmats/1205Lu/MXE_1205.txt")
RI_1205Lu <- read.delim("/Users/rjfisher/Library/Mobile Documents/com~apple~CloudDocs/BUSM/Alani Lab/DATA/CoREST Splicing/rmats/raw_rmats/1205Lu/RI_1205.txt")
#Filter SE FDR<0.05 and deltaPSI >= |0.1|
SE_1205Lu <- SE_1205Lu[SE_1205Lu$FDR < 0.05,]
SE_1205Lu <- SE_1205Lu[SE_1205Lu$IncLevelDifference<=(-0.1) | SE_1205Lu$IncLevelDifference>=(0.1),]
#Filter A3SS FDR<0.05 and deltaPSI >= |0.1|
A3SS_1205Lu <- A3SS_1205Lu[A3SS_1205Lu$FDR < 0.05,]
A3SS_1205Lu <- A3SS_1205Lu[A3SS_1205Lu$IncLevelDifference<=(-0.1) | A3SS_1205Lu$IncLevelDifference>=(0.1),]
#Filter A5SS FDR<0.05 and deltaPSI >= |0.1|
A5SS_1205Lu <- A5SS_1205Lu[A5SS_1205Lu$FDR < 0.05,]
A5SS_1205Lu <- A5SS_1205Lu[A5SS_1205Lu$IncLevelDifference<=(-0.1) | A5SS_1205Lu$IncLevelDifference>=(0.1),]
#Filter MXE FDR<0.05 and deltaPSI >= |0.1|
MXE_1205Lu <- MXE_1205Lu[MXE_1205Lu$FDR < 0.05,]
MXE_1205Lu <- MXE_1205Lu[MXE_1205Lu$IncLevelDifference<=(-0.1) | MXE_1205Lu$IncLevelDifference>=(0.1),]
#Filter RI FDR<0.05 and deltaPSI >= |0.1|
RI_1205Lu <- RI_1205Lu[RI_1205Lu$FDR < 0.05,]
RI_1205Lu <- RI_1205Lu[RI_1205Lu$IncLevelDifference<=(-0.1) | RI_1205Lu$IncLevelDifference>=(0.1),]
SE_451Lu <- read.delim("/Users/rjfisher/Library/Mobile Documents/com~apple~CloudDocs/BUSM/Alani Lab/DATA/CoREST Splicing/rmats/raw_rmats/451Lu/SE_451.txt")
A3SS_451Lu <- read.delim("/Users/rjfisher/Library/Mobile Documents/com~apple~CloudDocs/BUSM/Alani Lab/DATA/CoREST Splicing/rmats/raw_rmats/451Lu/A3SS_451.txt")
A5SS_451Lu <- read.delim("/Users/rjfisher/Library/Mobile Documents/com~apple~CloudDocs/BUSM/Alani Lab/DATA/CoREST Splicing/rmats/raw_rmats/451Lu/A5SS_451.txt")
MXE_451Lu <- read.delim("/Users/rjfisher/Library/Mobile Documents/com~apple~CloudDocs/BUSM/Alani Lab/DATA/CoREST Splicing/rmats/raw_rmats/451Lu/MXE_451.txt")
RI_451Lu <- read.delim("/Users/rjfisher/Library/Mobile Documents/com~apple~CloudDocs/BUSM/Alani Lab/DATA/CoREST Splicing/rmats/raw_rmats/451Lu/RI_451.txt")
#Filter SE FDR<0.05 and deltaPSI >= |0.1|
SE_451Lu <- SE_451Lu[SE_451Lu$FDR < 0.05,]
SE_451Lu <- SE_451Lu[SE_451Lu$IncLevelDifference<=(-0.1) | SE_451Lu$IncLevelDifference>=(0.1),]
#Filter A3SS FDR<0.05 and deltaPSI >= |0.1|
A3SS_451Lu <- A3SS_451Lu[A3SS_451Lu$FDR < 0.05,]
A3SS_451Lu <- A3SS_451Lu[A3SS_451Lu$IncLevelDifference<=(-0.1) | A3SS_451Lu$IncLevelDifference>=(0.1),]
#Filter A5SS FDR<0.05 and deltaPSI >= |0.1|
A5SS_451Lu <- A5SS_451Lu[A5SS_451Lu$FDR < 0.05,]
A5SS_451Lu <- A5SS_451Lu[A5SS_451Lu$IncLevelDifference<=(-0.1) | A5SS_451Lu$IncLevelDifference>=(0.1),]
#Filter MXE FDR<0.05 and deltaPSI >= |0.1|
MXE_451Lu <- MXE_451Lu[MXE_451Lu$FDR < 0.05,]
MXE_451Lu <- MXE_451Lu[MXE_451Lu$IncLevelDifference<=(-0.1) | MXE_451Lu$IncLevelDifference>=(0.1),]
#Filter RI FDR<0.05 and deltaPSI >= |0.1|
RI_451Lu <- RI_451Lu[RI_451Lu$FDR < 0.05,]
RI_451Lu <- RI_451Lu[RI_451Lu$IncLevelDifference<=(-0.1) | RI_451Lu$IncLevelDifference>=(0.1),]
SE_SKMEL5 <- read.delim("/Users/rjfisher/Library/Mobile Documents/com~apple~CloudDocs/BUSM/Alani Lab/DATA/CoREST Splicing/rmats/raw_rmats/SKMEL5/SE_SKMEL5.txt")
A3SS_SKMEL5 <- read.delim("/Users/rjfisher/Library/Mobile Documents/com~apple~CloudDocs/BUSM/Alani Lab/DATA/CoREST Splicing/rmats/raw_rmats/SKMEL5/A3SS_SKMEL5.txt")
A5SS_SKMEL5 <- read.delim("/Users/rjfisher/Library/Mobile Documents/com~apple~CloudDocs/BUSM/Alani Lab/DATA/CoREST Splicing/rmats/raw_rmats/SKMEL5/A5SS_SKMEL5.txt")
MXE_SKMEL5 <- read.delim("/Users/rjfisher/Library/Mobile Documents/com~apple~CloudDocs/BUSM/Alani Lab/DATA/CoREST Splicing/rmats/raw_rmats/SKMEL5/MXE_SKMEL5.txt")
RI_SKMEL5 <- read.delim("/Users/rjfisher/Library/Mobile Documents/com~apple~CloudDocs/BUSM/Alani Lab/DATA/CoREST Splicing/rmats/raw_rmats/SKMEL5/RI_SKMEL5.txt")
#Filter SE FDR<0.05 and deltaPSI >= |0.1|
SE_SKMEL5 <- SE_SKMEL5[SE_SKMEL5$FDR < 0.05,]
SE_SKMEL5 <- SE_SKMEL5[SE_SKMEL5$IncLevelDifference<=(-0.1) | SE_SKMEL5$IncLevelDifference>=(0.1),]
#Filter A3SS FDR<0.05 and deltaPSI >= |0.1|
A3SS_SKMEL5 <- A3SS_SKMEL5[A3SS_SKMEL5$FDR < 0.05,]
A3SS_SKMEL5 <- A3SS_SKMEL5[A3SS_SKMEL5$IncLevelDifference<=(-0.1) | A3SS_SKMEL5$IncLevelDifference>=(0.1),]
#Filter A5SS FDR<0.05 and deltaPSI >= |0.1|
A5SS_SKMEL5 <- A5SS_SKMEL5[A5SS_SKMEL5$FDR < 0.05,]
A5SS_SKMEL5 <- A5SS_SKMEL5[A5SS_SKMEL5$IncLevelDifference<=(-0.1) | A5SS_SKMEL5$IncLevelDifference>=(0.1),]
#Filter MXE FDR<0.05 and deltaPSI >= |0.1|
MXE_SKMEL5 <- MXE_SKMEL5[MXE_SKMEL5$FDR < 0.05,]
MXE_SKMEL5 <- MXE_SKMEL5[MXE_SKMEL5$IncLevelDifference<=(-0.1) | MXE_SKMEL5$IncLevelDifference>=(0.1),]
#Filter RI FDR<0.05 and deltaPSI >= |0.1|
RI_SKMEL5 <- RI_SKMEL5[RI_SKMEL5$FDR < 0.05,]
RI_SKMEL5 <- RI_SKMEL5[RI_SKMEL5$IncLevelDifference<=(-0.1) | RI_SKMEL5$IncLevelDifference>=(0.1),]
write.csv(SE_SKMEL5, file="SE_SKMEL5_filtered.csv")
SE_SKMEL24 <- read.delim("/Users/rjfisher/Library/Mobile Documents/com~apple~CloudDocs/BUSM/Alani Lab/DATA/CoREST Splicing/rmats/raw_rmats/SKMEL24/SE_SKMEL24.txt")
A3SS_SKMEL24 <- read.delim("/Users/rjfisher/Library/Mobile Documents/com~apple~CloudDocs/BUSM/Alani Lab/DATA/CoREST Splicing/rmats/raw_rmats/SKMEL24/A3SS_SKMEL24.txt")
A5SS_SKMEL24 <- read.delim("/Users/rjfisher/Library/Mobile Documents/com~apple~CloudDocs/BUSM/Alani Lab/DATA/CoREST Splicing/rmats/raw_rmats/SKMEL24/A5SS_SKMEL24.txt")
MXE_SKMEL24 <- read.delim("/Users/rjfisher/Library/Mobile Documents/com~apple~CloudDocs/BUSM/Alani Lab/DATA/CoREST Splicing/rmats/raw_rmats/SKMEL24/MXE_SKMEL24.txt")
RI_SKMEL24 <- read.delim("/Users/rjfisher/Library/Mobile Documents/com~apple~CloudDocs/BUSM/Alani Lab/DATA/CoREST Splicing/rmats/raw_rmats/SKMEL24/RI_SKMEL24.txt")
#Filter SE FDR<0.05 and deltaPSI >= |0.1|
SE_SKMEL24 <- SE_SKMEL24[SE_SKMEL24$FDR < 0.05,]
SE_SKMEL24 <- SE_SKMEL24[SE_SKMEL24$IncLevelDifference<=(-0.1) | SE_SKMEL24$IncLevelDifference>=(0.1),]
#Filter A3SS FDR<0.05 and deltaPSI >= |0.1|
A3SS_SKMEL24 <- A3SS_SKMEL24[A3SS_SKMEL24$FDR < 0.05,]
A3SS_SKMEL24 <- A3SS_SKMEL24[A3SS_SKMEL24$IncLevelDifference<=(-0.1) | A3SS_SKMEL24$IncLevelDifference>=(0.1),]
#Filter A5SS FDR<0.05 and deltaPSI >= |0.1|
A5SS_SKMEL24 <- A5SS_SKMEL24[A5SS_SKMEL24$FDR < 0.05,]
A5SS_SKMEL24 <- A5SS_SKMEL24[A5SS_SKMEL24$IncLevelDifference<=(-0.1) | A5SS_SKMEL24$IncLevelDifference>=(0.1),]
#Filter MXE FDR<0.05 and deltaPSI >= |0.1|
MXE_SKMEL24 <- MXE_SKMEL24[MXE_SKMEL24$FDR < 0.05,]
MXE_SKMEL24 <- MXE_SKMEL24[MXE_SKMEL24$IncLevelDifference<=(-0.1) | MXE_SKMEL24$IncLevelDifference>=(0.1),]
#Filter RI FDR<0.05 and deltaPSI >= |0.1|
RI_SKMEL24 <- RI_SKMEL24[RI_SKMEL24$FDR < 0.05,]
RI_SKMEL24 <- RI_SKMEL24[RI_SKMEL24$IncLevelDifference<=(-0.1) | RI_SKMEL24$IncLevelDifference>=(0.1),]
SE_SKMEL28 <- read.delim("/Users/rjfisher/Library/Mobile Documents/com~apple~CloudDocs/BUSM/Alani Lab/DATA/CoREST Splicing/rmats/raw_rmats/SKMEL28/SE_SKMEL28.txt")
A3SS_SKMEL28 <- read.delim("/Users/rjfisher/Library/Mobile Documents/com~apple~CloudDocs/BUSM/Alani Lab/DATA/CoREST Splicing/rmats/raw_rmats/SKMEL28/A3SS_SKMEL28.txt")
A5SS_SKMEL28 <- read.delim("/Users/rjfisher/Library/Mobile Documents/com~apple~CloudDocs/BUSM/Alani Lab/DATA/CoREST Splicing/rmats/raw_rmats/SKMEL28/A5SS_SKMEL28.txt")
MXE_SKMEL28 <- read.delim("/Users/rjfisher/Library/Mobile Documents/com~apple~CloudDocs/BUSM/Alani Lab/DATA/CoREST Splicing/rmats/raw_rmats/SKMEL28/MXE_SKMEL28.txt")
RI_SKMEL28 <- read.delim("/Users/rjfisher/Library/Mobile Documents/com~apple~CloudDocs/BUSM/Alani Lab/DATA/CoREST Splicing/rmats/raw_rmats/SKMEL28/RI_SKMEL28.txt")
#Filter SE FDR<0.05 and deltaPSI >= |0.1|
SE_SKMEL28 <- SE_SKMEL28[SE_SKMEL28$FDR < 0.05,]
SE_SKMEL28 <- SE_SKMEL28[SE_SKMEL28$IncLevelDifference<=(-0.1) | SE_SKMEL28$IncLevelDifference>=(0.1),]
#Filter A3SS FDR<0.05 and deltaPSI >= |0.1|
A3SS_SKMEL28 <- A3SS_SKMEL28[A3SS_SKMEL28$FDR < 0.05,]
A3SS_SKMEL28 <- A3SS_SKMEL28[A3SS_SKMEL28$IncLevelDifference<=(-0.1) | A3SS_SKMEL28$IncLevelDifference>=(0.1),]
#Filter A5SS FDR<0.05 and deltaPSI >= |0.1|
A5SS_SKMEL28 <- A5SS_SKMEL28[A5SS_SKMEL28$FDR < 0.05,]
A5SS_SKMEL28 <- A5SS_SKMEL28[A5SS_SKMEL28$IncLevelDifference<=(-0.1) | A5SS_SKMEL28$IncLevelDifference>=(0.1),]
#Filter MXE FDR<0.05 and deltaPSI >= |0.1|
MXE_SKMEL28 <- MXE_SKMEL28[MXE_SKMEL28$FDR < 0.05,]
MXE_SKMEL28 <- MXE_SKMEL28[MXE_SKMEL28$IncLevelDifference<=(-0.1) | MXE_SKMEL28$IncLevelDifference>=(0.1),]
#Filter RI FDR<0.05 and deltaPSI >= |0.1|
RI_SKMEL28 <- RI_SKMEL28[RI_SKMEL28$FDR <= 0.05,]
RI_SKMEL28 <- RI_SKMEL28[RI_SKMEL28$IncLevelDifference<=(-0.1) | RI_SKMEL28$IncLevelDifference>=(0.1),]
SE_WM793 <- read.delim("/Users/rjfisher/Library/Mobile Documents/com~apple~CloudDocs/BUSM/Alani Lab/DATA/CoREST Splicing/rmats/raw_rmats/WM793/SE_WM793.txt")
A3SS_WM793 <- read.delim("/Users/rjfisher/Library/Mobile Documents/com~apple~CloudDocs/BUSM/Alani Lab/DATA/CoREST Splicing/rmats/raw_rmats/WM793/A3SS_WM793.txt")
A5SS_WM793 <- read.delim("/Users/rjfisher/Library/Mobile Documents/com~apple~CloudDocs/BUSM/Alani Lab/DATA/CoREST Splicing/rmats/raw_rmats/WM793/A5SS_WM793.txt")
MXE_WM793 <- read.delim("/Users/rjfisher/Library/Mobile Documents/com~apple~CloudDocs/BUSM/Alani Lab/DATA/CoREST Splicing/rmats/raw_rmats/WM793/MXE_WM793.txt")
RI_WM793 <- read.delim("/Users/rjfisher/Library/Mobile Documents/com~apple~CloudDocs/BUSM/Alani Lab/DATA/CoREST Splicing/rmats/raw_rmats/WM793/RI_WM793.txt")
#Filter SE FDR<0.05 and deltaPSI >= |0.1|
SE_WM793 <- SE_WM793[SE_WM793$FDR < 0.05,]
SE_WM793 <- SE_WM793[SE_WM793$IncLevelDifference<=(-0.1) | SE_WM793$IncLevelDifference>=(0.1),]
#Filter A3SS FDR<0.05 and deltaPSI >= |0.1|
A3SS_WM793 <- A3SS_WM793[A3SS_WM793$FDR < 0.05,]
A3SS_WM793 <- A3SS_WM793[A3SS_WM793$IncLevelDifference<=(-0.1) | A3SS_WM793$IncLevelDifference>=(0.1),]
#Filter A5SS FDR<0.05 and deltaPSI >= |0.1|
A5SS_WM793 <- A5SS_WM793[A5SS_WM793$FDR < 0.05,]
A5SS_WM793 <- A5SS_WM793[A5SS_WM793$IncLevelDifference<=(-0.1) | A5SS_WM793$IncLevelDifference>=(0.1),]
#Filter MXE FDR<0.05 and deltaPSI >= |0.1|
MXE_WM793 <- MXE_WM793[MXE_WM793$FDR < 0.05,]
MXE_WM793 <- MXE_WM793[MXE_WM793$IncLevelDifference<=(-0.1) | MXE_WM793$IncLevelDifference>=(0.1),]
#Filter RI FDR<0.05 and deltaPSI >= |0.1|
RI_WM793 <- RI_WM793[RI_WM793$FDR < 0.05,]
RI_WM793 <- RI_WM793[RI_WM793$IncLevelDifference<=(-0.1) | RI_WM793$IncLevelDifference>=(0.1),]
overlap_events_1205_451 = SE_1205_exon %>% full_join(SE_451_exon, by="exon")
#install.packages("UpSetR")
library(UpSetR)
#remotes::install_github("jokergoo/ComplexHeatmap")
library(ComplexHeatmap)
SE_1205_exon <- SE_1205Lu %>%
mutate(exon = paste(exonStart_0base, exonEnd, sep = "-"))
SE_451_exon <- SE_451Lu %>%
mutate(exon = paste(exonStart_0base, exonEnd, sep = "-"))
SE_SKMEL5_exon <- SE_SKMEL5 %>%
mutate(exon = paste(exonStart_0base, exonEnd, sep = "-"))
SE_SKMEL24_exon <- SE_SKMEL24 %>%
mutate(exon = paste(exonStart_0base, exonEnd, sep = "-"))
SE_SKMEL28_exon <- SE_SKMEL28 %>%
mutate(exon = paste(exonStart_0base, exonEnd, sep = "-"))
SE_WM793_exon <- SE_WM793 %>%
mutate(exon = paste(exonStart_0base, exonEnd, sep = "-"))
SE_1205_event <- SE_1205_exon$exon
SE_451_event <- SE_451_exon$exon
SE_WM793_event <- SE_WM793_exon$exon
SE_SKMEL5_event <- SE_SKMEL5_exon$exon
SE_SKMEL24_event <- SE_SKMEL24_exon$exon
SE_SKMEL28_event <- SE_SKMEL28_exon$exon
overlap_events_1205_451 = SE_1205_exon %>% full_join(SE_451_exon, by="exon")
overlap_events_1205_451_WM793 = overlap_events_1205_451 %>% full_join(SE_WM793_exon, by="exon")
overlap_events_1205_451_WM793_SKMEL5 = overlap_events_1205_451_WM793 %>% full_join(SE_SKMEL5_exon, by="exon")
overlap_events_1205_451_WM793_SKMEL5_SKMEL24 = overlap_events_1205_451_WM793_SKMEL5 %>% full_join(SE_SKMEL24_exon, by="exon")
all_overlap_event = overlap_events_1205_451_WM793_SKMEL5_SKMEL24 %>% full_join(SE_SKMEL28_exon, by="exon")
all_overlap_event<- na.omit(all_overlap_event)
all_overlap_event <- all_overlap_event[!duplicated(all_overlap_event$exon), ]
all_overlap_event <- all_overlap_event %>% rename(`1205Lu`=IncLevelDifference.x, `451Lu`=IncLevelDifference.y, WM793 = IncLevelDifference.x.x, SKMEL5 = IncLevelDifference.y.y, SKMEL24 = IncLevelDifference.x.x.x, SKMEL28 = IncLevelDifference.y.y.y) %>% select(ID.x,`1205Lu`, `451Lu`, WM793, SKMEL5, SKMEL24, SKMEL28)
rownames(all_overlap_event) <- all_overlap_event[,1]
all_overlap_event <- all_overlap_event[,-1]
all_overlap_event <- all_overlap_event %>%
# transpose the matrix so genes are as columns
t() %>%
# apply scalling to each column of the matrix (genes)
scale() %>%
# transpose back so genes are as rows again
t()
library(circlize)
# Create the heatmap
heatmap <- Heatmap(
all_overlap_event,
name = "Log2FC",
cluster_columns = TRUE,
cluster_rows = TRUE,
column_title = NA,
show_row_names = TRUE,
show_column_names = TRUE,
col = colorRamp2(c(-1, 0, 1), colors = c("blue", "white", "red")),
#fontsize_row = 10,  # Adjust fontsize for row names
#fontsize_col = 10,  # Adjust fontsize for column names
column_names_rot = 45,
border_gp = gpar(col = "black"),
#main = "DE Splicing Factors",
row_dend_side = "left",
column_dend_side = "top",
#dend_width = unit(5, "mm"),  # Adjust dendrogram width
row_names_gp = gpar(fontsize = 9),  # Adjust fontsize for row names
column_names_gp = gpar(fontsize = 10),  # Adjust fontsize for column names
heatmap_legend_param = list(at = c(-1,0,1))  # Adjust legend breaks
)
# Draw the heatmap
draw(heatmap)
overlap_events_1205_451 = SE_1205_exon %>% full_join(SE_451_exon, by="exon")
overlap_events_1205_451_WM793 = overlap_events_1205_451 %>% full_join(SE_WM793_exon, by="exon")
overlap_events_1205_451_WM793_SKMEL5 = overlap_events_1205_451_WM793 %>% full_join(SE_SKMEL5_exon, by="exon")
overlap_events_1205_451_WM793_SKMEL5_SKMEL24 = overlap_events_1205_451_WM793_SKMEL5 %>% full_join(SE_SKMEL24_exon, by="exon")
all_overlap_event = overlap_events_1205_451_WM793_SKMEL5_SKMEL24 %>% full_join(SE_SKMEL28_exon, by="exon")
all_overlap_event<- na.omit(all_overlap_event)
all_overlap_event <- all_overlap_event[!duplicated(all_overlap_event$exon), ]
write.csv(all_overlap_event, file="all_overlap_event.csv")
all_overlap_event_heatmap <- all_overlap_event %>% select(ID.x,DMSO_1205Lu,Corin_1205Lu,DMSO_451Lu,Corin_451Lu,DMSO_WM793,Corin_WM793,DMSO_SKMEL5,Corin_SKMEL5,DMSO_SKMEL24,Corin_SKMEL24,DMSO_SKMEL28,Corin_SKMEL28)
overlap_events_1205_451 = SE_1205_exon %>% full_join(SE_451_exon, by="exon")
overlap_events_1205_451_WM793 = overlap_events_1205_451 %>% full_join(SE_WM793_exon, by="exon")
overlap_events_1205_451_WM793_SKMEL5 = overlap_events_1205_451_WM793 %>% full_join(SE_SKMEL5_exon, by="exon")
overlap_events_1205_451_WM793_SKMEL5_SKMEL24 = overlap_events_1205_451_WM793_SKMEL5 %>% full_join(SE_SKMEL24_exon, by="exon")
all_overlap_event = overlap_events_1205_451_WM793_SKMEL5_SKMEL24 %>% full_join(SE_SKMEL28_exon, by="exon")
all_overlap_event<- na.omit(all_overlap_event)
all_overlap_event <- all_overlap_event[!duplicated(all_overlap_event$exon), ]
all_overlap_event <- all_overlap_event %>% rename(`1205Lu`=IncLevelDifference.x, `451Lu`=IncLevelDifference.y, WM793 = IncLevelDifference.x.x, SKMEL5 = IncLevelDifference.y.y, SKMEL24 = IncLevelDifference.x.x.x, SKMEL28 = IncLevelDifference.y.y.y) %>% select(ID.x,`1205Lu`, `451Lu`, WM793, SKMEL5, SKMEL24, SKMEL28)
rownames(all_overlap_event) <- all_overlap_event[,1]
all_overlap_event <- all_overlap_event[,-1]
View(all_overlap_event)
all_overlap_event_heatmap <- all_overlap_event %>%
# transpose the matrix so genes are as columns
t() %>%
# apply scalling to each column of the matrix (genes)
scale() %>%
# transpose back so genes are as rows again
t()
my_sample_col <- data.frame(Treatment = c("DMSO", "Corin","DMSO", "Corin","DMSO", "Corin","DMSO", "Corin","DMSO", "Corin","DMSO", "Corin"))
row.names(my_sample_col) <- colnames(all_overlap_event_heatmap)
# Function to calculate average of two values separated by comma
average_two_values <- function(x) {
values <- as.numeric(unlist(strsplit(x, ",")))
mean(values, na.rm = TRUE)
}
# Apply the function to the "two_values" column and create a new column "average_values"
SE_1205_exon$DMSO_1205Lu <- sapply(SE_1205_exon$IncLevel1, average_two_values)
SE_1205_exon$Corin_1205Lu <- sapply(SE_1205_exon$IncLevel2, average_two_values)
SE_451_exon$DMSO_451Lu <- sapply(SE_451_exon$IncLevel1, average_two_values)
SE_451_exon$Corin_451Lu <- sapply(SE_451_exon$IncLevel2, average_two_values)
SE_WM793_exon$DMSO_WM793 <- sapply(SE_WM793_exon$IncLevel1, average_two_values)
SE_WM793_exon$Corin_WM793 <- sapply(SE_WM793_exon$IncLevel2, average_two_values)
SE_SKMEL5_exon$DMSO_SKMEL5 <- sapply(SE_SKMEL5_exon$IncLevel1, average_two_values)
SE_SKMEL5_exon$Corin_SKMEL5 <- sapply(SE_SKMEL5_exon$IncLevel2, average_two_values)
SE_SKMEL24_exon$DMSO_SKMEL24 <- sapply(SE_SKMEL24_exon$IncLevel1, average_two_values)
SE_SKMEL24_exon$Corin_SKMEL24 <- sapply(SE_SKMEL24_exon$IncLevel2, average_two_values)
SE_SKMEL28_exon$DMSO_SKMEL28 <- sapply(SE_SKMEL28_exon$IncLevel1, average_two_values)
SE_SKMEL28_exon$Corin_SKMEL28 <- sapply(SE_SKMEL28_exon$IncLevel2, average_two_values)
overlap_events_1205_451 = SE_1205_exon %>% full_join(SE_451_exon, by="exon")
overlap_events_1205_451_WM793 = overlap_events_1205_451 %>% full_join(SE_WM793_exon, by="exon")
overlap_events_1205_451_WM793_SKMEL5 = overlap_events_1205_451_WM793 %>% full_join(SE_SKMEL5_exon, by="exon")
overlap_events_1205_451_WM793_SKMEL5_SKMEL24 = overlap_events_1205_451_WM793_SKMEL5 %>% full_join(SE_SKMEL24_exon, by="exon")
all_overlap_event = overlap_events_1205_451_WM793_SKMEL5_SKMEL24 %>% full_join(SE_SKMEL28_exon, by="exon")
all_overlap_event<- na.omit(all_overlap_event)
all_overlap_event <- all_overlap_event[!duplicated(all_overlap_event$exon), ]
write.csv(all_overlap_event, file="all_overlap_event.csv")
all_overlap_event_heatmap <- all_overlap_event %>% select(ID.x,DMSO_1205Lu,Corin_1205Lu,DMSO_451Lu,Corin_451Lu,DMSO_WM793,Corin_WM793,DMSO_SKMEL5,Corin_SKMEL5,DMSO_SKMEL24,Corin_SKMEL24,DMSO_SKMEL28,Corin_SKMEL28)
rownames(all_overlap_event_heatmap) <- all_overlap_event_heatmap[,1]
all_overlap_event_heatmap <- all_overlap_event_heatmap[,-1]
all_overlap_event_heatmap <- all_overlap_event_heatmap %>%
# transpose the matrix so genes are as columns
t() %>%
# apply scalling to each column of the matrix (genes)
scale() %>%
# transpose back so genes are as rows again
t()
my_sample_col <- data.frame(Treatment = c("DMSO", "Corin","DMSO", "Corin","DMSO", "Corin","DMSO", "Corin","DMSO", "Corin","DMSO", "Corin"))
row.names(my_sample_col) <- colnames(all_overlap_event_heatmap)
# Draw heatmaps
#paletteLength <- 74
color=colorRampPalette(c("dodgerblue3", "white", "red"))(50)
fontsize_row = 8 - nrow(all_overlap_event) / 15
PSI_heatmap_plot <-pheatmap(t(all_overlap_event_heatmap),
#clustering_distance_cols  = "euclidean",
#clustering_method = "ward.D",
cluster_rows = T,
border_color = NA,
#show_rownames = F,
#show_colnames = F,
annotation_colors = my_colour,
annotation_row = my_sample_col,
#cutree_cols = 2,
#cutree_rows = 2,
color = color,
labels_col=all_overlap_event$geneSymbol.x,
fontsize_col = 7,
angle_col = c("45"),
#legend_breaks = c(-1, 0, 1),
main= "Skipped Exon Events"
)
my_colour = list(Treatment = c(DMSO = "#b2b2b2", Corin = "dodgerblue2"))
my_color = list(Treatment = c(DMSO = "#b2b2b2", Corin = "dodgerblue2"))
# Draw heatmaps
#paletteLength <- 74
color=colorRampPalette(c("dodgerblue3", "white", "red"))(50)
fontsize_row = 8 - nrow(all_overlap_event) / 15
PSI_heatmap_plot <-pheatmap(t(all_overlap_event_heatmap),
#clustering_distance_cols  = "euclidean",
#clustering_method = "ward.D",
cluster_rows = T,
border_color = NA,
#show_rownames = F,
#show_colnames = F,
annotation_colors = my_color,
annotation_row = my_sample_col,
#cutree_cols = 2,
#cutree_rows = 2,
color = color,
labels_col=all_overlap_event$geneSymbol.x,
fontsize_col = 7,
angle_col = c("45"),
#legend_breaks = c(-1, 0, 1),
main= "Skipped Exon Events"
)
PSI_heatmap_plot
my_color = list(Treatment = c(DMSO = "#b2b2b2", Corin = "dodgerblue3"))
# Draw heatmaps
#paletteLength <- 74
color=colorRampPalette(c("dodgerblue3", "white", "red"))(50)
fontsize_row = 8 - nrow(all_overlap_event) / 15
PSI_heatmap_plot <-pheatmap(t(all_overlap_event_heatmap),
#clustering_distance_cols  = "euclidean",
#clustering_method = "ward.D",
cluster_rows = T,
border_color = NA,
#show_rownames = F,
#show_colnames = F,
annotation_colors = my_color,
annotation_row = my_sample_col,
#cutree_cols = 2,
#cutree_rows = 2,
color = color,
labels_col=all_overlap_event$geneSymbol.x,
fontsize_col = 7,
angle_col = c("45"),
#legend_breaks = c(-1, 0, 1),
main= "Skipped Exon Events"
)
PSI_heatmap_plot
View(all_overlap_event)
View(all_overlap_event_heatmap)
# Draw heatmaps
#paletteLength <- 74
color=colorRampPalette(c("dodgerblue3", "white", "red"))(50)
fontsize_row = 8 - nrow(all_overlap_event) / 15
PSI_heatmap_plot <-pheatmap(t(all_overlap_event_heatmap),
#clustering_distance_cols  = "euclidean",
#clustering_method = "ward.D",
cluster_rows = T,
border_color = NA,
#show_rownames = F,
#show_colnames = F,
annotation_colors = my_color,
annotation_row = my_sample_col,
#cutree_cols = 2,
#cutree_rows = 2,
color = color,
labels_col=all_overlap_event$geneSymbol.x,
fontsize_col = 7,
angle_col = c("45"),
legend_breaks = c(-3, 0, 3),
main= "Skipped Exon Events"
)
PSI_heatmap_plot
# Draw heatmaps
#paletteLength <- 74
color=colorRampPalette(c("dodgerblue3", "white", "red"))(50)
fontsize_row = 8 - nrow(all_overlap_event) / 15
PSI_heatmap_plot <-pheatmap(t(all_overlap_event_heatmap),
#clustering_distance_cols  = "euclidean",
#clustering_method = "ward.D",
cluster_rows = T,
border_color = NA,
#show_rownames = F,
#show_colnames = F,
annotation_colors = my_color,
annotation_row = my_sample_col,
#cutree_cols = 2,
#cutree_rows = 2,
color = color,
labels_col=all_overlap_event$geneSymbol.x,
fontsize_col = 7,
angle_col = c("45"),
legend_breaks = c(-3, -2,-1, 0, 1,2, 3),
main= "Skipped Exon Events"
)
PSI_heatmap_plot
pdf(file="PSI_heatmap_plot.pdf", width = 9, height = 4)
PSI_heatmap_plot
dev.off()
# Draw heatmaps
#paletteLength <- 74
color=colorRampPalette(c("dodgerblue3", "white", "red"))(50)
fontsize_row = 8 - nrow(all_overlap_event) / 15
PSI_heatmap_plot <-pheatmap(t(all_overlap_event_heatmap),
#clustering_distance_cols  = "euclidean",
#clustering_method = "ward.D",
cluster_rows = T,
border_color = NA,
show_rownames = F,
show_colnames = F,
annotation_colors = my_color,
annotation_row = my_sample_col,
#cutree_cols = 2,
#cutree_rows = 2,
color = color,
labels_col=all_overlap_event$geneSymbol.x,
fontsize_col = 7,
angle_col = c("45"),
legend_breaks = c(-3, -2,-1, 0, 1,2, 3),
main= "Skipped Exon Events"
)
PSI_heatmap_plot
pdf(file="PSI_heatmap_plot.pdf", width = 9, height = 4)
PSI_heatmap_plot
dev.off()
# Draw heatmaps
#paletteLength <- 74
color=colorRampPalette(c("dodgerblue3", "white", "red"))(50)
fontsize_row = 8 - nrow(all_overlap_event) / 15
PSI_heatmap_plot <-pheatmap(t(all_overlap_event_heatmap),
#clustering_distance_cols  = "euclidean",
#clustering_method = "ward.D",
cluster_rows = T,
border_color = c("black"),
show_rownames = F,
show_colnames = F,
annotation_colors = my_color,
annotation_row = my_sample_col,
#cutree_cols = 2,
#cutree_rows = 2,
color = color,
labels_col=all_overlap_event$geneSymbol.x,
fontsize_col = 7,
angle_col = c("45"),
legend_breaks = c(-3, -2,-1, 0, 1,2, 3),
main= "Skipped Exon Events"
)
PSI_heatmap_plot
# Draw heatmaps
#paletteLength <- 74
color=colorRampPalette(c("dodgerblue3", "white", "red"))(50)
fontsize_row = 8 - nrow(all_overlap_event) / 15
PSI_heatmap_plot <-pheatmap(t(all_overlap_event_heatmap),
#clustering_distance_cols  = "euclidean",
#clustering_method = "ward.D",
cluster_rows = T,
border_color = NA,
show_rownames = F,
show_colnames = F,
annotation_colors = my_color,
annotation_row = my_sample_col,
#cutree_cols = 2,
#cutree_rows = 2,
color = color,
labels_col=all_overlap_event$geneSymbol.x,
fontsize_col = 7,
angle_col = c("45"),
legend_breaks = c(-3, -2,-1, 0, 1,2, 3),
main= "Skipped Exon Events"
)
PSI_heatmap_plot
# Draw heatmaps
#paletteLength <- 74
color=colorRampPalette(c("dodgerblue3", "white", "red"))(50)
fontsize_row = 8 - nrow(all_overlap_event) / 15
PSI_heatmap_plot <-pheatmap(t(all_overlap_event_heatmap),
#clustering_distance_cols  = "euclidean",
#clustering_method = "ward.D",
cluster_rows = T,
border_color = NA,
show_rownames = F,
show_colnames = F,
annotation_colors = my_color,
annotation_row = my_sample_col,
#cutree_cols = 2,
#cutree_rows = 2,
color = color,
labels_col=all_overlap_event$geneSymbol.x,
fontsize_col = 7,
angle_col = c("45"),
legend_breaks = c(-4,0,4),
main= "Skipped Exon Events"
)
PSI_heatmap_plot
